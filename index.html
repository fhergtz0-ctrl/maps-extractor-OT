<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scrapping Tool ‚Äî Google Places</title>

<!-- Favicon simple para evitar 404 -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><rect width='128' height='128' rx='24' fill='%230b0b0b'/><text x='50%' y='58%' dominant-baseline='middle' text-anchor='middle' font-size='68' fill='%231db954'>S</text></svg>">

<style>
  :root{
    --bg:#0b0b0b; --panel:#151923; --muted:#9aa1b4; --text:#eaeef5; --accent:#22c55e;
    --chip:#1e2535; --border:#2a3042; --pill:#0f1524; --warn:#f59e0b;
  }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0; font:14px/1.45 system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial; background:var(--bg); color:var(--text)}
  .wrap{max-width:1600px; margin:22px auto; padding:0 16px}

  /* Barra superior con todas las opciones */
  .toolbar{
    display:grid;
    grid-template-columns: 1.2fr 1fr 1fr 1fr 1fr 0.9fr 0.7fr auto auto;
    gap:10px; background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:12px; align-items:start
  }
  .grp{ display:flex; flex-direction:column; gap:6px }
  .lbl{ font-size:12px; color:var(--muted) }
  textarea, input[type="text"], input[type="number"], select{
    width:100%; background:#0e1222; color:var(--text); border:1px solid var(--border); border-radius:10px; padding:10px; resize:vertical; outline:none
  }
  textarea{ height:60px }
  .chips{ display:flex; flex-wrap:wrap; gap:8px; background:#0e1222; border:1px solid var(--border); border-radius:12px; padding:10px; min-height:60px }
  .chip{ display:inline-flex; align-items:center; gap:8px; padding:8px 10px; background:var(--chip); border:1px solid var(--border); border-radius:999px; font-size:12px; color:#d8def0 }
  .actions{ display:flex; gap:8px; align-items:center; justify-content:flex-end }
  button{ background:var(--accent); color:#07180c; border:0; border-radius:999px; padding:10px 14px; font-weight:600; cursor:pointer }
  .ghost{ background:#2a3042; color:#e5e7eb }

  .status{
    margin:12px 0; background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:12px;
    font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; max-height:160px; overflow:auto; white-space:pre-wrap
  }
  .metrics{ display:flex; align-items:center; gap:12px; color:var(--muted); margin-bottom:6px }
  .pill{ display:inline-block; padding:4px 8px; border-radius:999px; background:var(--pill); border:1px solid var(--border); color:var(--muted); font-size:12px }

  .table-wrap{ margin-top:10px; background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:8px; overflow:auto }
  table{ width:3200px; border-collapse:separate; border-spacing:0 }
  thead th{ position:sticky; top:0; z-index:1; background:#0f1526; color:#cbd5e1; text-align:left; font-weight:700; padding:8px 10px; border-bottom:1px solid var(--border) }
  tbody td{ padding:8px 10px; border-bottom:1px solid var(--border); vertical-align:top; font-size:14px; white-space:nowrap }
  a{ color:#93c5fd; text-decoration:none } a:hover{text-decoration:underline}
</style>
</head>
<body>
<div class="wrap">
  <h2 style="margin:0 0 12px 6px;">Scrapping Tool <span style="color:var(--muted); font-weight:400">‚Äî Google Maps Places</span></h2>

  <!-- BARRA COMPLETA -->
  <div class="toolbar">
    <div class="grp">
      <div class="lbl">AC / Prospect (aplica a todos los resultados)</div>
      <select id="acType">
        <option value="">‚Äî</option>
        <option value="AC">AC</option>
        <option value="Prospect">Prospect</option>
      </select>
    </div>

    <div class="grp">
      <div class="lbl">Keywords</div>
      <textarea id="kw" placeholder="Restaurante&#10;Pizzer√≠a"></textarea>
    </div>

    <div class="grp">
      <div class="lbl">Ciudad(es)</div>
      <textarea id="ciudades" placeholder="Hermosillo&#10;Nogales"></textarea>
    </div>

    <div class="grp">
      <div class="lbl">Estado(s)</div>
      <textarea id="estados" placeholder="Sonora&#10;Sinaloa"></textarea>
    </div>

    <div class="grp">
      <div class="lbl">Colonia(s) (opcional)</div>
      <textarea id="colonias" placeholder="Centro&#10;Pitic"></textarea>
    </div>

    <div class="grp">
      <div class="lbl">C√≥digos postales (opcional)</div>
      <textarea id="zips" placeholder="83000&#10;83260"></textarea>
    </div>

    <div class="grp">
      <div class="lbl">API Key</div>
      <input id="apiKey" type="text" placeholder="Pegar aqu√≠ la Key">
      <div class="chips" style="margin-top:6px">
        <label class="chip"><input id="t-latlng" type="checkbox" checked>Lat &amp; Long</label>
        <label class="chip"><input id="t-website" type="checkbox" checked>Website</label>
        <label class="chip"><input id="t-email" type="checkbox">Email</label>
      </div>
    </div>

    <div class="grp">
      <div class="lbl">Radio por consulta (km)</div>
      <input id="radiusKm" type="number" min="1" max="50" value="3">
      <div class="lbl" style="margin-top:8px">Seg m√°x. email</div>
      <input id="maxEmailSec" type="number" min="3" max="30" value="10">
    </div>

    <div class="grp">
      <div class="lbl">Campos extra</div>
      <div class="chips">
        <label class="chip"><input id="x-hours" type="checkbox">Horario</label>
        <label class="chip"><input id="x-price" type="checkbox">Precio</label>
        <label class="chip"><input id="x-mapsuri" type="checkbox">Maps URI</label>
        <label class="chip"><input id="x-photo" type="checkbox">Foto</label>
        <label class="chip"><input id="x-types" type="checkbox" checked>Tipo + Subtipos</label>
        <label class="chip"><input id="x-short" type="checkbox">Short Addr</label>
        <label class="chip"><input id="x-summary" type="checkbox">Resumen</label>
        <label class="chip"><input id="x-partners" type="checkbox" checked>Partners (Reserva/Delivery)</label>
      </div>
    </div>

    <div class="actions">
      <button id="start">Iniciar</button>
      <button id="download" class="ghost">Descargar</button>
    </div>
  </div>

  <div class="metrics">
    <span class="pill">üëÅÔ∏è Visitas: <b id="m-visits">‚Äî</b></span>
    <span class="pill">‚öôÔ∏è Extracciones: <b id="m-runs">‚Äî</b></span>
    <span class="pill">üìç Pa√≠s: <b id="m-country">‚Ä¶</b></span>
  </div>
  <pre class="status" id="log">Listo para iniciar‚Ä¶</pre>

  <!-- TABLA COMPLETA (todas las columnas que pediste) -->
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>AC or Prospect</th>
          <th>KW</th>
          <th>State</th>
          <th>City</th>
          <th>Colony</th>
          <th>Company Name</th>
          <th>Category</th>
          <th>Website</th>
          <th>Phone</th>
          <th>email</th>
          <th>address</th>
          <th>Postal Code + City</th>
          <th>state</th>
          <th>pin code</th>
          <th># Reviews</th>
          <th>Review</th>
          <th>CID</th>
          <th>MapLink</th>
          <th>Lat</th>
          <th>Lng</th>
          <th>Tipo + Subtipos</th>
          <th>Precio</th>
          <th>Horario</th>
          <th>Resumen</th>
          <th>Foto</th>
          <th>Partners</th>
        </tr>
      </thead>
      <tbody id="body"></tbody>
    </table>
  </div>
</div>

<script>
  const $ = s => document.querySelector(s);
  const log = (m,k="")=>{ const el=$("#log"); el.textContent+=(el.textContent?"\n":"")+m; el.scrollTop=el.scrollHeight; console[(k==="err"?"error":k==="warn"?"warn":"log")](m); };
  const setVisits = v => $("#m-visits").textContent = v ?? "‚Äî";
  const setRuns = v => $("#m-runs").textContent = v ?? "‚Äî";
  const setCountry = v => $("#m-country").textContent = v ?? "‚Äî";

  // M√©tricas (silenciosas si fallan)
  const NS = location.host || "localdev";
  const capi = (kind,key)=>fetch(`https://api.countapi.xyz/${kind}/${encodeURIComponent(NS)}/${encodeURIComponent(key)}`).then(r=>r.ok?r.json():null).catch(()=>null);
  (async()=>{
    try{ const v=await capi("get","pageviews"); setVisits(v?.value); }catch{}
    try{ const r=await capi("get","runs"); setRuns(r?.value); }catch{}
    try{ const ip=await fetch("https://ipapi.co/json/"); const j=await ip.json(); setCountry(`${j.country_name||j.country||"?"} (${j.country||"?"})`); }catch{}
  })();

  // Toggles
  const toggles = { latlng:true, website:true, email:false, hours:false, price:false, maps:false, photo:false, types:true, short:false, summary:false, partners:true };
  const idMap = {
    "t-latlng":"latlng","t-website":"website","t-email":"email","x-hours":"hours","x-price":"price","x-mapsuri":"maps",
    "x-photo":"photo","x-types":"types","x-short":"short","x-summary":"summary","x-partners":"partners"
  };
  Object.keys(idMap).forEach(id=>{
    const el=$("#"+id); if(!el) return;
    toggles[idMap[id]] = el.checked;
    el.addEventListener("change", ()=> toggles[idMap[id]] = el.checked);
  });

  // --- Partners / Reserva & Delivery (con fallback sin CORS) ---
  const PARTNER_DOMAINS = [
    { key:'OpenTable', type:'reservation', host:'opentable.' },
    { key:'UberEats',  type:'delivery',   host:'ubereats.' },
    { key:'Rappi',     type:'delivery',   host:'rappi.' },
    { key:'DiDi Food', type:'delivery',   host:'didi-food.' },
    { key:'DoorDash',  type:'delivery',   host:'doordash.' },
    { key:'PedidosYa', type:'delivery',   host:'pedidosya.' },
    { key:'Just Eat',  type:'delivery',   host:'just-eat.' },
    { key:'Glovo',     type:'delivery',   host:'glovo.' },
    { key:'SinDelantal', type:'delivery', host:'sindelantal.' }
  ];
  const PARTNER_KEYWORDS = [
    { key:'OpenTable', type:'reservation', kw:'opentable' },
    { key:'UberEats',  type:'delivery',    kw:'uber eats' },
    { key:'Rappi',     type:'delivery',    kw:'rappi' },
    { key:'DiDi Food', type:'delivery',    kw:'didi food' },
    { key:'DoorDash',  type:'delivery',    kw:'doordash' },
    { key:'PedidosYa', type:'delivery',    kw:'pedidos ya' },
    { key:'Just Eat',  type:'delivery',    kw:'just eat' },
    { key:'Glovo',     type:'delivery',    kw:'glovo' },
    { key:'SinDelantal', type:'delivery',  kw:'sin delantal' }
  ];
  function normalizeUrl(u){ if(!u) return ''; let out=String(u).trim(); if(!/^https?:\/\//i.test(out)) out='https://'+out; return out; }
  async function fetchWithTimeout(url, {timeout=7000, mode='cors'}={}){
    const ctrl=new AbortController(); const t=setTimeout(()=>ctrl.abort(), timeout);
    try{ const r=await fetch(url,{signal:ctrl.signal,mode}); clearTimeout(t); if(!r.ok) throw new Error(r.status); return await r.text(); }
    catch{ clearTimeout(t); return ''; }
  }
  async function fetchReadableProxy(url){
    const u=new URL(normalizeUrl(url));
    const prox=`https://r.jina.ai/${u.protocol}//${u.host}${u.pathname}${u.search||''}`;
    return await fetchWithTimeout(prox,{timeout:7000, mode:'cors'});
  }
  function detectPartnersFromText(text=''){
    const t=text.toLowerCase();
    const res=new Set(), del=new Set();
    for(const p of PARTNER_DOMAINS){ if(t.includes(p.host)) (p.type==='reservation'?res:del).add(p.key); }
    for(const p of PARTNER_KEYWORDS){ if(t.includes(p.kw)) (p.type==='reservation'?res:del).add(p.key); }
    const list=[];
    if(res.size) list.push(`Reserva: ${Array.from(res).join('|')}`);
    if(del.size) list.push(`Delivery: ${Array.from(del).join('|')}`);
    return list.join(' | ');
  }
  async function detectPartners(websiteUrl){
    const url=normalizeUrl(websiteUrl); if(!url) return '';
    let html=await fetchWithTimeout(url,{timeout:7000,mode:'cors'});
    if(!html) html=await fetchReadableProxy(url);
    if(!html) return '';
    return detectPartnersFromText(html);
  }

  // --- Places API v1 ---
  function buildFieldMask(){
    const fm = [
      "places.id","places.displayName","places.primaryType","places.types",
      "places.formattedAddress","places.addressComponents",
      "places.location","places.googleMapsUri",
      "places.rating","places.userRatingCount",
      "places.nationalPhoneNumber","places.internationalPhoneNumber",
      "nextPageToken"
    ];
    if (toggles.website) fm.push("places.websiteUri");
    if (toggles.short)   fm.push("places.shortFormattedAddress");
    if (toggles.price)   fm.push("places.priceLevel");
    if (toggles.hours)   fm.push("places.currentOpeningHours.openNow","places.currentOpeningHours.weekdayDescriptions");
    if (toggles.types)   fm.push("places.primaryTypeDisplayName");
    if (toggles.summary) fm.push("places.editorialSummary");
    if (toggles.photo)   fm.push("places.photos.name");
    return fm.join(",");
  }

  async function geocodeCenterByText(apiKey, text){
    // Centro aproximado usando Places searchText (1 resultado)
    const url='https://places.googleapis.com/v1/places:searchText';
    const body={ textQuery:text, maxResultCount:1, languageCode:"es", regionCode:"MX" };
    const r=await fetch(url,{ method:'POST', headers:{
      'Content-Type':'application/json','X-Goog-Api-Key':apiKey,'X-Goog-FieldMask':'places.location,places.displayName'
    }, body:JSON.stringify(body)});
    if(!r.ok) return null;
    const j=await r.json(); return j.places?.[0]?.location || null;
  }

  async function textSearchAll(apiKey, query, center, radiusM){
    const results=[]; let token; const mask=buildFieldMask();
    do{
      const body={ textQuery:query, pageSize:20, languageCode:"es", regionCode:"MX", locationBias:{ circle:{ center, radius: radiusM } }, pageToken:token };
      const r=await fetch('https://places.googleapis.com/v1/places:searchText',{ method:'POST', headers:{
        'Content-Type':'application/json','X-Goog-Api-Key':apiKey,'X-Goog-FieldMask':mask
      }, body:JSON.stringify(body)});
      if(!r.ok){ const t=await r.text().catch(()=>r.statusText); throw new Error(`HTTP ${r.status}: ${t}`); }
      const j=await r.json();
      if(Array.isArray(j.places)) results.push(...j.places);
      token=j.nextPageToken||null;
      if(token) await new Promise(rs=>setTimeout(rs,1200));
    }while(token);
    return results;
  }

  // Parse addressComponents
  const acGet=(ac,type)=> (ac||[]).find(c=>Array.isArray(c.types) && c.types.includes(type))?.longText || '';
  function parseAddressComponents(ac){
    const postal = acGet(ac,'postal_code');
    const city   = acGet(ac,'locality') || acGet(ac,'postal_town') || acGet(ac,'administrative_area_level_2') || acGet(ac,'sublocality');
    const state  = acGet(ac,'administrative_area_level_1');
    const colony = acGet(ac,'sublocality') || acGet(ac,'neighborhood') || '';
    return { postal, city, state, colony };
  }

  // Email simple
  function extractEmail(html){
    if(!html) return '';
    const m1 = html.match(/mailto:([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,})/);
    if(m1) return m1[1];
    const m2 = html.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,}/);
    return m2?m2[0]:"";
  }
  async function detectEmail(websiteUrl, maxSecs){
    const url = normalizeUrl(websiteUrl); if(!url) return '';
    let html = await fetchWithTimeout(url,{timeout:Math.max(3000,maxSecs*1000)});
    if(!html) html = await fetchReadableProxy(url);
    return extractEmail(html);
  }

  // Render & CSV
  function renderRows(rows){
    const tb=$("#body"); tb.innerHTML="";
    for(const r of rows){
      const tr=document.createElement("tr");
      const vals=[
        r.acType, r.kw, r.state_in, r.city_in, r.colony_in,
        r.name, r.category, r.website, r.phone, r.email, r.address,
        r.cpCity, r.state_real, r.pin_code, r.reviews, r.rating, r.cid,
        r.maplink, r.lat, r.lng, r.types, r.price, r.hours, r.summary, r.photo, r.partners
      ];
      vals.forEach((v,i)=>{
        const td=document.createElement("td");
        if(i===7 || i===16){ // Website/MapLink
          if(v){ td.innerHTML=`<a href="${v}" target="_blank" rel="noopener">link</a>`; }
        } else { td.textContent = v==null?"":String(v); }
        tr.appendChild(td);
      });
      tb.appendChild(tr);
    }
  }
  function toCSV(rows){
    const head=[
      "AC or Prospect","KW","State","City","Colony","Company Name","Category","Website","Phone","email","address",
      "Postal Code + City","state","pin code","# Reviews","Review","CID","MapLink","Lat","Lng","Tipo + Subtipos","Precio","Horario","Resumen","Foto","Partners"
    ];
    const esc=v=>v==null?"":(/[",\n]/.test(String(v))?`"${String(v).replace(/"/g,'""')}"`:v);
    return [head.join(","), ...rows.map(r=>[
      r.acType,r.kw,r.state_in,r.city_in,r.colony_in,r.name,r.category,r.website,r.phone,r.email,r.address,
      r.cpCity,r.state_real,r.pin_code,r.reviews,r.rating,r.cid,r.maplink,r.lat,r.lng,r.types,r.price,r.hours,r.summary,r.photo,r.partners
    ].map(esc).join(","))].join("\n");
  }
  function downloadCSV(rows,name="results.csv"){
    const blob=new Blob([toCSV(rows)],{type:"text/csv;charset=utf-8"});
    const url=URL.createObjectURL(blob); const a=document.createElement("a");
    a.href=url; a.download=name; a.click(); URL.revokeObjectURL(url);
  }

  // START
  $("#start").addEventListener("click", async ()=>{
    const key=$("#apiKey").value.trim(); if(!key){ alert("Pega tu API Key"); return; }
    const acType=$("#acType").value;

    const kws=$("#kw").value.split(/[\n,]+/).map(s=>s.trim()).filter(Boolean);
    const ciudades=$("#ciudades").value.split(/[\n,]+/).map(s=>s.trim()).filter(Boolean);
    const estados=$("#estados").value.split(/[\n,]+/).map(s=>s.trim()).filter(Boolean);
    const colonias=$("#colonias").value.split(/[\n,]+/).map(s=>s.trim()).filter(Boolean);
    const zips=$("#zips").value.split(/[\n,]+/).map(s=>s.trim()).filter(Boolean);
    const rKm=Math.max(1,parseInt($("#radiusKm").value||"3",10)); const rM=rKm*1000;

    if(!kws.length || (!ciudades.length && !estados.length && !colonias.length && !zips.length)){
      alert("Escribe al menos 1 keyword y alguna ubicaci√≥n (ciudad/estado/colonia/CP)."); return;
    }

    $("#body").innerHTML=""; $("#log").textContent="Iniciando‚Ä¶";
    capi("hit","runs").then(x=>setRuns(x?.value)).catch(()=>{});

    const rows=[]; const seen=new Set();

    // Generar targets de b√∫squeda (entrada ‚Üí columnas State/City/Colony)
    const targets=[];
    const C=ciudades.length?ciudades:[""]; const E=estados.length?estados:[""];
    if(colonias.length){
      for(const city of C) for(const state of E) for(const col of colonias){
        const label=[col,city,state,"MX"].filter(Boolean).join(", ");
        targets.push({state_in:state, city_in:city, colony_in:col, label});
      }
    }else{
      for(const city of C) for(const state of E){
        const label=[city,state,"MX"].filter(Boolean).join(", ");
        targets.push({state_in:state, city_in:city, colony_in:"", label});
      }
    }
    for(const z of zips){ if(z){ targets.push({state_in:"", city_in:"", colony_in:"", label:`${z}, MX`}); } }

    for(const t of targets){
      const center = await geocodeCenterByText(key, t.label);
      if(!center){ log(`No se pudo geolocalizar: ${t.label}`,"warn"); continue; }

      for(const kw of kws){
        log(`"${kw}" @ "${t.label}" (radio ${rKm} km)‚Ä¶`);
        let places=[];
        try{ places=await textSearchAll(key, kw, center, rM); }
        catch(e){ log(`Error: ${e.message}`,"err"); continue; }
        log(`‚Üí ${places.length} resultados.`);

        for(const p of places){
          if(!p.id || seen.has(p.id)) continue; seen.add(p.id);
          const ac = parseAddressComponents(p.addressComponents||[]);
          const website = toggles.website ? (p.websiteUri||"") : "";

          // Email + Partners (solo si hay website y est√°n activos)
          let email=""; let partners="";
          if(website){
            if(toggles.email){ email = await detectEmail(website, parseInt($("#maxEmailSec").value||"10",10)); }
            if(toggles.partners){ partners = await detectPartners(website); }
          }

          // Tipos / Subtipos
          let tipos=""; if(toggles.types){
            const primary = p.primaryTypeDisplayName?.text || p.primaryType || "";
            const subs = Array.isArray(p.types)?p.types.filter(x=>x!==p.primaryType).join("|"):"";
            tipos = primary + (subs?` | ${subs}`:"");
          }

          // Horario
          let hours=""; if(toggles.hours){
            const h=p.currentOpeningHours;
            hours = h?.weekdayDescriptions?.join(" | ") || (h?.openNow!=null ? (h.openNow?"abierto":"cerrado") : "");
          }

          // Resumen
          let summary=""; if(toggles.summary){ summary = p.editorialSummary?.text || ""; }

          // Foto
          let photo=""; if(toggles.photo){ photo = (p.photos && p.photos[0]?.name) ? p.photos[0].name : ""; }

          // Precio
          let price=""; if(toggles.price){ price = (p.priceLevel!=null)?String(p.priceLevel):""; }

          const row={
            acType: acType||"",
            kw,
            state_in: t.state_in||"",
            city_in: t.city_in||"",
            colony_in: t.colony_in||"",
            name: p.displayName?.text||"",
            category: p.primaryType||"",
            website,
            phone: p.nationalPhoneNumber || p.internationalPhoneNumber || "",
            email,
            address: p.formattedAddress||"",
            cpCity: (ac.postal && ac.city)?`${ac.postal} ${ac.city}`:(ac.postal||ac.city||""),
            state_real: ac.state||"",
            pin_code: ac.postal||"",
            reviews: p.userRatingCount ?? "",
            rating: p.rating ?? "",
            cid: p.id || "",
            maplink: toggles.maps ? (p.googleMapsUri||"") : (p.googleMapsUri||""),
            lat: toggles.latlng ? (p.location?.latitude??"") : "",
            lng: toggles.latlng ? (p.location?.longitude??"") : "",
            types: tipos,
            price,
            hours,
            summary,
            photo,
            partners
          };
          rows.push(row);
        }
      }
    }

    renderRows(rows);
    log(`Proceso finalizado. Lugares √∫nicos: ${rows.length}.`);
  });

  $("#download").addEventListener("click", ()=>{
    const tb=$("#body"); if(!tb.firstChild){ alert("No hay datos."); return; }
    // reconstruimos desde la tabla (para respetar lo que ve el usuario)
    const rows=[]; [...tb.querySelectorAll("tr")].forEach(tr=>{
      const tds=[...tr.children].map(td=>td.querySelector("a")?td.querySelector("a").href:td.textContent);
      const obj={
        acType:tds[0], kw:tds[1], state_in:tds[2], city_in:tds[3], colony_in:tds[4],
        name:tds[5], category:tds[6], website:tds[7], phone:tds[8], email:tds[9], address:tds[10],
        cpCity:tds[11], state_real:tds[12], pin_code:tds[13], reviews:tds[14], rating:tds[15], cid:tds[16],
        maplink:tds[17], lat:tds[18], lng:tds[19], types:tds[20], price:tds[21], hours:tds[22], summary:tds[23], photo:tds[24], partners:tds[25]
      };
      rows.push(obj);
    });
    downloadCSV(rows);
  });
</script>
</body>
</html>
